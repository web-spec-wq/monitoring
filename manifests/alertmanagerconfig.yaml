apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: alertmanager-config
  namespace: python-monitoring
  labels:
    release: prometheus-stack 
   
spec:
  route:
    receiver: slack-notifications
    groupBy:
      - alertname
      - namespace
    groupWait: 5s
    groupInterval: 10s
    repeatInterval: 1m

  receivers:
    - name: slack-notifications
      slackConfigs:
        - channel: '#social'
          apiURL:
            name: monitoring-secret
            key: webhook_url
            namespace: python-monitoring
          sendResolved: true
          text: |
            *Alert:* {{ .CommonLabels.alertname }}
            *Namespace:* {{ .CommonLabels.namespace }}
            *Severity:* {{ .CommonLabels.severity }}
            *Summary:* {{ .CommonAnnotations.summary }}
            *Description:* {{ .CommonAnnotations.description }}
        
